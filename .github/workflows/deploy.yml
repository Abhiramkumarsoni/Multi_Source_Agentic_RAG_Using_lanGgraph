# GitHub Actions workflow to deploy to Hugging Face Spaces
# This runs automatically when you push to the main branch

name: Deploy to Hugging Face Spaces

# When to run this workflow
on:
    push:
        branches:
            - main # Runs when you push to main branch
    workflow_dispatch: # Allows manual trigger from GitHub UI

jobs:
    deploy:
        runs-on: ubuntu-latest

        steps:
            # Step 1: Download your code
            - name: Checkout Repository
              uses: actions/checkout@v4
              with:
                  fetch-depth: 0 # Get full git history
                  lfs: true # Support large files

            # Step 2: Push to Hugging Face Spaces
            - name: Push to Hugging Face Hub
              run: |
                  # Configure git
                  git config --global user.email "github-actions[bot]@users.noreply.github.com"
                  git config --global user.name "github-actions[bot]"

                  # Add Hugging Face remote with token authentication
                  # Format: https://USER:TOKEN@huggingface.co/spaces/USERNAME/SPACE_NAME
                  git remote add huggingface https://user:${{ secrets.HF_TOKEN }}@huggingface.co/spaces/${{ secrets.HF_USERNAME }}/${{ secrets.HF_SPACE_NAME }}

                  # Force push to Hugging Face
                  git push huggingface main --force
